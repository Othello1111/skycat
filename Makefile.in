# E.S.O. - VLT project 
# "@(#) $Id: Makefile.in,v 1.4 1998/10/28 17:35:54 abrighto Exp $"
#
# Makefile.in
#
# start make in the subdirectories

# set this to the top level install dir
PREFIX = $(PWD)/install

# flags to pass to configure (gcc can do -O with -g)
CONFIGURE_FLAGS = --with-gcc

# directories in which to run make (set by configure)
SUBDIRS = @subdirs@

all install clean depend man: FORCE
	for i in $(SUBDIRS); do (cd $$i; echo "$$i:"; $(MAKE) $@) done

quick: FORCE
	@for i in tclutil astrotcl rtd cat skycat/interp; \
	do (cd $$i; echo "$$i:"; $(MAKE) all) done
	(cd skycat; $(MAKE) master_lib)

# make clean and remove any generated makefiles
distclean: 
	-for i in $(SUBDIRS); do (cd $$i; echo "$$i:"; $(MAKE) $@) done
	-rm -rf ./tmp/*
	-find . -type f \( -name '*~' \
		-o -name 'Makefile.bak' \
		-o -name '*.flc' \
		-o -name '*.so' \
		-o -name '*.[oa]' \
		-o -name '.objs' \
		-o -name core \
		-o -name 'config.cache' \) -print -exec rm -f {} \;
	for i in `find $(SUBDIRS) -type f -name '*.in' -print` ;\
	do test "`basename $$i`" != "configure.in" && rm -f `dirname $$i`/`basename $$i .in` ;\
	done

# run configure and make with the given flags
All World world: configure 
	$(MAKE) all install

# run configure with the given flags
configure: FORCE
	./configure -prefix $(PREFIX) $(CONFIGURE_FLAGS)

autoconf: FORCE
	-for i in . $(SUBDIRS) ;\
	 do (cd $$i; echo "$$i:"; autoconf) done

tags:
	etags Makefile `find . \
	\( \
	-name '*.[Cch]' \
	-o -name '*.tcl' \
	-o -name '*.in' \
	\) -print`

itcltags:
	tcltags \
	    tclutil/tclutil/library/[A-Z]*.tcl \
	    rtd/rtdimg/library/[A-Z]*.tcl \
	    cat/tclcat/library/[A-Z]*.tcl \
	    skycat/interp/library/[A-Z]*.tcl

# generate man page sources from itcl source files (run make man afterwards)
doc cleandoc:
	-for i in tclutil/tclutil astrotcl/astrotcl rtd/rtdimg cat/tclcat skycat/interp ;\
	 do (cd $$i/library; echo "$$i/library:"; $(MAKE) $@) done

# generate the tclIndex files
tclIndex index:
	-for i in tclutil/tclutil astrotcl/astrotcl rtd/rtdimg cat/tclcat skycat/interp plugins/gaia/gaia ;\
	 do (cd $$i/library; echo "$$i/library:"; $(MAKE) $@) done

# run make in the given subdirs...
$(SUBDIRS): FORCE
	for i in $@ ; do (cd $$i; echo "$$i:"; $(MAKE)) done


FORCE:
